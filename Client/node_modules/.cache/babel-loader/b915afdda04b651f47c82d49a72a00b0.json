{"ast":null,"code":"var _jsxFileName = \"/Users/benjamincritoph/Programming/React/chess/src/Board.js\";\nimport './Board.css';\nimport React from 'react';\nimport Square from './Square';\nimport { Piece, King, Queen, Knight, Bishop, Rook } from './Pieces';\nimport { arrayEquals, setupBoard } from './Helpers';\nimport { Howl, Howler } from 'howler';\nimport ChessGame from './ChessGame';\nimport { jsxDEV as _jsxDEV } from \"react/jsx-dev-runtime\";\nconst BLACK = false;\nconst WHITE = true;\nconst soundEffects = {\n  whiteMove: \"./whiteMove.wav\",\n  blackMove: \"./blackMove.wav\"\n};\nlet Game = new ChessGame();\n\nclass Board extends React.Component {\n  constructor(props) {\n    super(props);\n    this.state = {\n      board: setupBoard(),\n      lastSelectedPiecePos: false,\n      turn: WHITE,\n      legalMoves: [],\n      kingPos: [[0, 4], [7, 4]],\n      inCheck: false,\n      checkmate: false,\n      winner: false,\n      castleCheck: [[true, true, true], [true, true, true]],\n      lastEnPassant: false,\n      draw: false,\n      promotePawn: false\n    };\n    this.resetBoard = this.resetBoard.bind(this);\n    this.dropMove = this.dropMove.bind(this);\n    this.selectPromote = this.selectPromote.bind(this);\n  } // Checks to see if another piece is selected\n\n\n  changeSelection(board, selectedPiece, newPos) {\n    const [r, c] = newPos;\n    const [or, oc] = selectedPiece;\n\n    if (board[or][oc].type === board[r][c].type && !(or === r && oc === c)) {\n      return true;\n    }\n\n    return false;\n  } // Called when a player promotes a pawn and selects piece to promote to\n\n\n  selectPromote(selectedPiecePos, newPiece) {\n    const [pr, pc] = selectedPiecePos;\n    const {\n      board,\n      kingPos,\n      castleCheck,\n      lastEnPassant,\n      turn\n    } = this.state;\n    let draw = false;\n    const kIdx = newPiece.type ? 0 : 1;\n    const kOppIdx = kIdx ? 0 : 1;\n    const newBoard = this.state.board;\n    newBoard[pr][pc] = newPiece; // Check if opponent in check\n\n    const inCheck = ChessGame.checkedOpponent(board, newPiece.type, kingPos[kOppIdx]); // Check for checkmate\n\n    if (inCheck && ChessGame.isCheckmate(board, newPiece, kingPos[kOppIdx])) {\n      this.setState({\n        winner: newPiece.type,\n        checkmate: true,\n        inCheck: true,\n        legalMoves: [],\n        lastSelectedPiecePos: false,\n        turn: !turn\n      });\n    } // Check for draw\n    else if (ChessGame.draw(board, newPiece, kingPos[kOppIdx], castleCheck, lastEnPassant)) {\n      this.setState({\n        draw: true,\n        legalMoves: [],\n        lastSelectedPiecePos: false,\n        turn: !turn\n      });\n    } else {\n      this.setState({\n        board: newBoard,\n        lastSelectedPiecePos: retBoard.lastSe,\n        turn: !turn,\n        legalMoves: [],\n        kingPos: retBoard.kingPos,\n        inCheck: retBoard.inCheck,\n        checkmate: retBoard.checkmate,\n        castleCheck: retBoard.castleCheck,\n        lastEnPassant: retBoard.lastEnPassant,\n        promotePawn: retBoard.promotePawn\n      });\n    }\n\n    this.setState({\n      board: newBoard,\n      promotePawn: false\n    });\n    console.log(this.state.board);\n  } // Called when player clicks on a piece\n\n\n  selectPiece(selectedPiecePos) {\n    const [r, c] = selectedPiecePos;\n    const {\n      board,\n      lastSelectedPiecePos,\n      kingPos,\n      inCheck,\n      castleCheck,\n      lastEnPassant,\n      draw,\n      turn,\n      promotePawn\n    } = this.state; // If a move is made\n\n    if (lastSelectedPiecePos && !this.changeSelection(board, lastSelectedPiecePos, selectedPiecePos)) {\n      if (arrayEquals(selectedPiecePos, lastSelectedPiecePos)) {\n        this.setState({\n          lastSelectedPiecePos: false,\n          legalMoves: []\n        });\n        return;\n      }\n\n      const [or, oc] = lastSelectedPiecePos;\n      const lastSelectedPiece = board[or][oc];\n      const retBoard = Game.move(board, lastSelectedPiecePos, selectedPiecePos, lastSelectedPiece, kingPos, inCheck, castleCheck, lastEnPassant, draw);\n\n      if (retBoard.checkmate) {\n        this.setState({\n          winner: lastSelectedPiece.type,\n          checkmate: true,\n          inCheck: true,\n          legalMoves: [],\n          lastSelectedPiecePos: false,\n          turn: !turn\n        });\n        return;\n      } else if (retBoard.draw) {\n        this.setState({\n          draw: true,\n          legalMoves: [],\n          lastSelectedPiecePos: false,\n          turn: !turn\n        });\n        return;\n      } else if (retBoard.board) {\n        this.setState({\n          board: retBoard.board,\n          lastSelectedPiecePos: retBoard.lastSelectedPiecePos,\n          turn: !turn,\n          legalMoves: [],\n          kingPos: retBoard.kingPos,\n          inCheck: retBoard.inCheck,\n          checkmate: retBoard.checkmate,\n          castleCheck: retBoard.castleCheck,\n          lastEnPassant: retBoard.lastEnPassant,\n          promotePawn: retBoard.promotePawn\n        });\n\n        if (turn === WHITE) {\n          console.log(\"Soundeffect\");\n          this.playSound(\"./soundEffects/whiteMove.wav\");\n        } else this.playSound(\"./soundEffects/blackMove.wav\");\n      }\n\n      return;\n    } // If piece is selected or switch to another piece\n\n\n    const selectedPiece = board[r][c];\n    if (!selectedPiece instanceof Piece || selectedPiece.type !== turn) return;\n    const kIdx = selectedPiece.type ? 0 : 1;\n    const cIdx = selectedPiece.type ? 0 : 1; // Show legal moves when piece is selected\n\n    const lMoves = selectedPiece.allowedMoves(board, selectedPiecePos, selectedPiece, kingPos[kIdx], castleCheck[cIdx], lastEnPassant);\n    this.setState({\n      lastSelectedPiecePos: selectedPiecePos,\n      legalMoves: lMoves\n    });\n  }\n\n  dropMove(movedSqr) {\n    this.selectPiece(movedSqr);\n  }\n\n  playSound(src) {\n    const sound = new Howl({\n      src\n    });\n    sound.play();\n  }\n\n  selectorSquares(pawnPromote) {\n    let arr = [];\n    const [r, c] = pawnPromote;\n    const turn = r === 7 ? WHITE : BLACK;\n\n    if (turn === WHITE) {\n      arr.push(new Bishop(WHITE, \"w_b\"), new Rook(WHITE, \"w_r\"), new Knight(WHITE, \"w_kn\"), new Queen(WHITE, \"w_q\"));\n    } else {\n      arr.push(new Queen(BLACK, \"b_q\"), new Knight(BLACK, \"b_kn\"), new Rook(BLACK, \"b_r\"), new Bishop(BLACK, \"b_b\"));\n    }\n\n    return arr;\n  }\n\n  selectorSquare(pawnPromote, selectSquares, pos) {\n    const [pr, pc] = pawnPromote;\n    const [r, c] = pos;\n    const turn = pr === 7 ? WHITE : BLACK;\n\n    if (turn === WHITE) {\n      if (c === pc && r >= 4 && r < 8) {\n        console.log(\"pr = \", pr);\n        return selectSquares[r - 4];\n      }\n    } else {\n      if (c === pc && r <= 3) {\n        return selectSquares[r];\n      }\n    }\n  } // Resets chessboard state\n\n\n  resetBoard() {\n    this.setState({\n      board: setupBoard(),\n      lastSelectedPiecePos: false,\n      turn: WHITE,\n      legalMoves: [],\n      kingPos: [[0, 4], [7, 4]],\n      inCheck: false,\n      checkmate: false,\n      winner: false,\n      castleCheck: [[true, true, true], [true, true, true]],\n      lastEnPassant: false,\n      draw: false,\n      promotePawn: false\n    });\n    Game = new ChessGame();\n  }\n\n  render() {\n    const {\n      board,\n      lastSelectedPiecePos,\n      turn,\n      legalMoves,\n      inCheck,\n      checkmate,\n      draw,\n      winner,\n      promotePawn\n    } = this.state;\n\n    let winMessage = /*#__PURE__*/_jsxDEV(\"div\", {\n      children: winner ? \"White Wins!!!\" : \"Black Wins!!!\"\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 213,\n      columnNumber: 22\n    }, this);\n\n    let chessBoard = [];\n    let cOdd = true;\n    let rOdd = true;\n    let selectorSquares;\n    let selectorSquare;\n    let pr, pc;\n\n    if (promotePawn) {\n      selectorSquares = this.selectorSquares(promotePawn);\n      console.log(selectorSquares);\n    } // Iterated through rows backwards so that white would be at row 0 similar to chess notation\n\n\n    for (let r = 7; r >= 0; r--) {\n      let row = [];\n      cOdd = rOdd;\n\n      for (let c = 0; c < this.props.nCols; c++) {\n        const sqr = `${String.fromCharCode(97 + c)}${r + 1}`;\n        const isDark = cOdd ? true : false;\n        const piece = board[r][c];\n        const pos = [r, c];\n        const isSelected = arrayEquals(pos, lastSelectedPiecePos);\n        const isLegalMove = legalMoves.some(lm => arrayEquals(lm, pos) ? true : false);\n        const isDraw = draw && piece instanceof King && turn === piece.type;\n        const kingInCheck = piece instanceof King && inCheck && turn === piece.type;\n        selectorSquare = false;\n\n        if (promotePawn) {\n          [pr, pc] = promotePawn;\n          selectorSquare = this.selectorSquare(promotePawn, selectorSquares, pos);\n          console.log(selectorSquare);\n        }\n\n        row.push( /*#__PURE__*/_jsxDEV(Square, {\n          pos: pos,\n          isDark: isDark,\n          piece: piece,\n          selectPiece: () => this.selectPiece([r, c]),\n          isSelected: isSelected,\n          isLegal: isLegalMove,\n          inCheck: kingInCheck,\n          isCheckmate: checkmate,\n          draw: isDraw,\n          dropMove: this.dropMove,\n          selectorSquare: selectorSquare,\n          selectPromote: this.selectPromote,\n          promotePos: promotePawn,\n          turn: turn\n        }, sqr, false, {\n          fileName: _jsxFileName,\n          lineNumber: 243,\n          columnNumber: 18\n        }, this));\n        cOdd = !cOdd;\n      }\n\n      chessBoard.push( /*#__PURE__*/_jsxDEV(\"tr\", {\n        className: \"Row\",\n        children: row\n      }, r + 1, false, {\n        fileName: _jsxFileName,\n        lineNumber: 246,\n        columnNumber: 23\n      }, this));\n      rOdd = !rOdd;\n    } // Render Chess Pieces\n\n\n    return /*#__PURE__*/_jsxDEV(\"div\", {\n      className: \"Board\",\n      children: [/*#__PURE__*/_jsxDEV(\"table\", {\n        className: \"Table\",\n        children: /*#__PURE__*/_jsxDEV(\"tbody\", {\n          children: chessBoard\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 253,\n          columnNumber: 11\n        }, this)\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 252,\n        columnNumber: 9\n      }, this), /*#__PURE__*/_jsxDEV(\"button\", {\n        onClick: this.resetBoard,\n        className: \"newGame\",\n        children: \"New Game\"\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 257,\n        columnNumber: 9\n      }, this)]\n    }, void 0, true, {\n      fileName: _jsxFileName,\n      lineNumber: 251,\n      columnNumber: 7\n    }, this);\n  }\n\n}\n\nBoard.defaultProps = {\n  nRows: 8,\n  nCols: 8\n};\nexport default Board;","map":{"version":3,"names":["React","Square","Piece","King","Queen","Knight","Bishop","Rook","arrayEquals","setupBoard","Howl","Howler","ChessGame","BLACK","WHITE","soundEffects","whiteMove","blackMove","Game","Board","Component","constructor","props","state","board","lastSelectedPiecePos","turn","legalMoves","kingPos","inCheck","checkmate","winner","castleCheck","lastEnPassant","draw","promotePawn","resetBoard","bind","dropMove","selectPromote","changeSelection","selectedPiece","newPos","r","c","or","oc","type","selectedPiecePos","newPiece","pr","pc","kIdx","kOppIdx","newBoard","checkedOpponent","isCheckmate","setState","retBoard","lastSe","console","log","selectPiece","lastSelectedPiece","move","playSound","cIdx","lMoves","allowedMoves","movedSqr","src","sound","play","selectorSquares","pawnPromote","arr","push","selectorSquare","selectSquares","pos","render","winMessage","chessBoard","cOdd","rOdd","row","nCols","sqr","String","fromCharCode","isDark","piece","isSelected","isLegalMove","some","lm","isDraw","kingInCheck","defaultProps","nRows"],"sources":["/Users/benjamincritoph/Programming/React/chess/src/Board.js"],"sourcesContent":["import './Board.css'\nimport React from 'react'\nimport Square from './Square';\nimport { Piece, King, Queen, Knight, Bishop, Rook } from './Pieces';\nimport { arrayEquals, setupBoard } from './Helpers';\nimport { Howl, Howler } from 'howler';\nimport ChessGame from './ChessGame';\n\nconst BLACK = false\nconst WHITE = true\n\nconst soundEffects = {\n  whiteMove: \"./whiteMove.wav\",\n  blackMove: \"./blackMove.wav\"\n}\n\nlet Game = new ChessGame();\n\nclass Board extends React.Component {\n  static defaultProps = {\n    nRows: 8,\n    nCols: 8,\n  }\n  constructor(props) {\n    super(props);\n    this.state = {\n      board: setupBoard(),\n      lastSelectedPiecePos: false,\n      turn: WHITE,\n      legalMoves: [],\n      kingPos: [[0, 4], [7, 4]],\n      inCheck: false,\n      checkmate: false,\n      winner: false,\n      castleCheck: [[true, true, true], [true, true, true]],\n      lastEnPassant: false,\n      draw: false, \n      promotePawn: false, \n      \n    }\n    this.resetBoard = this.resetBoard.bind(this);\n    this.dropMove = this.dropMove.bind(this);\n    this.selectPromote = this.selectPromote.bind(this);\n  }\n  // Checks to see if another piece is selected\n  changeSelection(board, selectedPiece, newPos) {\n    const [r, c] = newPos;\n    const [or, oc] = selectedPiece;\n    if ((board[or][oc].type === board[r][c].type) && !(or === r && oc === c)) {\n      return true;\n    }\n    return false;\n  }\n  // Called when a player promotes a pawn and selects piece to promote to\n  selectPromote(selectedPiecePos, newPiece) {\n    const [pr, pc] = selectedPiecePos;\n    const {board, kingPos, castleCheck, lastEnPassant, turn} = this.state;\n    let draw = false;\n    const kIdx = newPiece.type? 0 : 1;\n    const kOppIdx = kIdx? 0: 1;\n    const newBoard = this.state.board;\n    newBoard[pr][pc] = newPiece;\n\n    // Check if opponent in check\n    const inCheck = ChessGame.checkedOpponent(board, newPiece.type, kingPos[kOppIdx]);\n    // Check for checkmate\n    if (inCheck && ChessGame.isCheckmate(board, newPiece, kingPos[kOppIdx])) {\n      this.setState({winner: newPiece.type, checkmate: true, inCheck: true, legalMoves: [], lastSelectedPiecePos: false, turn: !turn});\n    }\n    // Check for draw\n    else if (ChessGame.draw(board, newPiece, kingPos[kOppIdx], castleCheck, lastEnPassant)) {\n      this.setState({draw: true, legalMoves: [], lastSelectedPiecePos: false, turn: !turn});\n    } \n    else {\n      this.setState({\n        board: newBoard, \n        lastSelectedPiecePos: retBoard.lastSe, \n        turn: !turn, \n        legalMoves: [], \n        kingPos: retBoard.kingPos, \n        inCheck: retBoard.inCheck, \n        checkmate: retBoard.checkmate, \n        castleCheck: retBoard.castleCheck, \n        lastEnPassant: retBoard.lastEnPassant,\n        promotePawn: retBoard.promotePawn\n      });\n    }\n\n\n\n\n\n    this.setState({board: newBoard, promotePawn: false});\n    console.log(this.state.board);\n  }\n\n  // Called when player clicks on a piece\n  selectPiece(selectedPiecePos) {\n    const [r, c] = selectedPiecePos;\n    const {board, lastSelectedPiecePos, kingPos, inCheck, castleCheck, lastEnPassant, draw, turn, promotePawn} = this.state;\n\n    // If a move is made\n    if (lastSelectedPiecePos && !this.changeSelection(board, lastSelectedPiecePos, selectedPiecePos)) {\n      if (arrayEquals(selectedPiecePos, lastSelectedPiecePos)){\n        this.setState({lastSelectedPiecePos: false, legalMoves: []})\n        return;\n      } \n      const [or, oc] = lastSelectedPiecePos;\n      const lastSelectedPiece = board[or][oc];\n      const retBoard = Game.move(board, lastSelectedPiecePos, selectedPiecePos, lastSelectedPiece, kingPos, inCheck, castleCheck, lastEnPassant, draw);\n      if (retBoard.checkmate) {\n        this.setState({winner: lastSelectedPiece.type, checkmate: true, inCheck: true, legalMoves: [], lastSelectedPiecePos: false, turn: !turn});\n        return;\n      }\n      else if (retBoard.draw) {\n        this.setState({draw: true, legalMoves: [], lastSelectedPiecePos: false, turn: !turn});\n        return;\n      }\n      else if (retBoard.board){\n        this.setState({\n          board: retBoard.board, \n          lastSelectedPiecePos: retBoard.lastSelectedPiecePos, \n          turn: !turn, \n          legalMoves: [], \n          kingPos: retBoard.kingPos, \n          inCheck: retBoard.inCheck, \n          checkmate: retBoard.checkmate, \n          castleCheck: retBoard.castleCheck, \n          lastEnPassant: retBoard.lastEnPassant,\n          promotePawn: retBoard.promotePawn\n        });\n        if (turn === WHITE) {\n          console.log(\"Soundeffect\");\n          this.playSound(\"./soundEffects/whiteMove.wav\");\n        }\n\n        else this.playSound(\"./soundEffects/blackMove.wav\");\n      } \n      return;\n    }\n    // If piece is selected or switch to another piece\n    const selectedPiece = board[r][c];\n    if (!selectedPiece instanceof Piece || selectedPiece.type !== turn) return;\n    const kIdx = selectedPiece.type? 0 : 1;\n    const cIdx = selectedPiece.type? 0 : 1;\n    // Show legal moves when piece is selected\n    const lMoves = selectedPiece.allowedMoves(board, selectedPiecePos, selectedPiece, kingPos[kIdx], castleCheck[cIdx], lastEnPassant);\n    this.setState({lastSelectedPiecePos: selectedPiecePos, legalMoves: lMoves});\n  }\n  dropMove(movedSqr) {\n    this.selectPiece(movedSqr);\n  }\n  playSound(src) {\n    const sound = new Howl({src});\n    sound.play();\n  }\n  selectorSquares (pawnPromote) {\n    let arr = [];\n    const [r, c] = pawnPromote;\n    const turn = (r === 7)? WHITE : BLACK;\n    if (turn === WHITE) {\n      arr.push(\n        new Bishop(WHITE, \"w_b\"),\n        new Rook(WHITE, \"w_r\"), \n        new Knight(WHITE, \"w_kn\"), \n        new Queen(WHITE, \"w_q\") \n      );\n    } else {\n      arr.push(\n        new Queen(BLACK, \"b_q\"),\n        new Knight(BLACK, \"b_kn\"),\n        new Rook(BLACK, \"b_r\"),\n        new Bishop(BLACK, \"b_b\")\n      );\n    }\n    return arr;\n  }\n  selectorSquare (pawnPromote, selectSquares, pos){\n    const [pr, pc] = pawnPromote;\n    const [r, c] = pos;\n    const turn = (pr === 7)? WHITE : BLACK;\n    if (turn === WHITE) {\n      if (c === pc && (r >= 4 && r < 8)) {\n        console.log(\"pr = \",pr)\n        return selectSquares[r - 4];\n      }\n    } else {\n      if (c === pc && (r <= 3)) {\n        return selectSquares[r];\n      }\n    }\n  }\n  // Resets chessboard state\n  resetBoard(){\n    this.setState({\n      board: setupBoard(), \n      lastSelectedPiecePos: false, \n      turn: WHITE, \n      legalMoves: [], \n      kingPos: [[0, 4], [7, 4]], \n      inCheck: false, \n      checkmate: false,\n      winner: false,\n      castleCheck: [[true, true, true], [true, true, true]],\n      lastEnPassant: false, \n      draw: false,\n      promotePawn: false\n    });\n    Game = new ChessGame();\n  }\n  render(){\n    const {board, lastSelectedPiecePos, turn, legalMoves, inCheck, checkmate, draw, winner, promotePawn} = this.state;\n    let winMessage = <div>{winner? \"White Wins!!!\" : \"Black Wins!!!\"}</div>\n    let chessBoard = [];\n    let cOdd = true;\n    let rOdd = true;\n    let selectorSquares;\n    let selectorSquare;\n    let pr, pc;\n    if (promotePawn) {\n      selectorSquares = this.selectorSquares(promotePawn);\n      console.log(selectorSquares);\n    }\n    // Iterated through rows backwards so that white would be at row 0 similar to chess notation\n    for(let r = 7; r >= 0; r--){\n      let row = [] \n      cOdd = rOdd;\n      for(let c = 0; c < this.props.nCols; c++){\n        const sqr = `${String.fromCharCode(97 + c)}${r + 1}`;\n        const isDark = cOdd? true: false;\n        const piece = board[r][c];\n        const pos = [r, c];\n        const isSelected = arrayEquals(pos, lastSelectedPiecePos);\n        const isLegalMove = legalMoves.some(lm => arrayEquals(lm, pos)? true : false);\n        const isDraw = draw && piece instanceof King && (turn === piece.type);\n        const kingInCheck = piece instanceof King && inCheck && (turn === piece.type);\n        selectorSquare = false;\n        if (promotePawn) {\n          [pr, pc] = promotePawn;\n          selectorSquare = this.selectorSquare(promotePawn, selectorSquares, pos); \n          console.log(selectorSquare)\n        }\n        row.push(<Square key={sqr} pos={pos} isDark={isDark} piece={piece} selectPiece={() => this.selectPiece([r,c])} isSelected={isSelected} isLegal={isLegalMove} inCheck={kingInCheck} isCheckmate={checkmate} draw={isDraw} dropMove={this.dropMove} selectorSquare={selectorSquare} selectPromote={this.selectPromote} promotePos={promotePawn} turn={turn}/>)\n        cOdd = !cOdd;\n      }\n      chessBoard.push(<tr className=\"Row\" key={r + 1}>{row}</tr>)   \n      rOdd = !rOdd;  \n    }\n    // Render Chess Pieces\n    return (\n      <div className=\"Board\">\n        <table className=\"Table\">\n          <tbody>\n            {chessBoard}\n          </tbody>\n        </table>\n        <button onClick={this.resetBoard}className=\"newGame\">New Game</button>\n      </div>\n    );\n  }\n}\n\nexport default Board;"],"mappings":"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"},"metadata":{},"sourceType":"module"}